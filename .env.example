# ============================================================================
# SHIKSHA SETU - ENVIRONMENT CONFIGURATION
# ============================================================================
# Copy this file to .env and update with your settings
#
# Quick Start:
#   cp .env.example .env
#   python -c "import secrets; print('JWT_SECRET_KEY=' + secrets.token_urlsafe(64))" >> .env
#
# ============================================================================

# ============================================================================
# APPLICATION
# ============================================================================
ENVIRONMENT=development          # development | staging | production
DEBUG=true                       # Enable debug mode (disable in production)
APP_NAME=ShikshaSetu AI Education API
APP_VERSION=3.0.0

# Deployment Tier (affects model loading strategy)
DEPLOYMENT_TIER=local            # local (M4/MPS) | production (GPU/vLLM)

# ============================================================================
# SERVER
# ============================================================================
HOST=0.0.0.0
PORT=8000

# ============================================================================
# DATABASE (PostgreSQL with pgvector)
# ============================================================================
# Local Development
DATABASE_URL=postgresql://postgres:password@localhost:5432/shiksha_setu

# Supabase (Production) - uncomment and configure
# DATABASE_URL=postgresql://postgres.YOUR_REF:YOUR_PASSWORD@aws-0-region.pooler.supabase.com:5432/postgres

# Connection Pool
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ============================================================================
# REDIS (Required for caching and Celery)
# ============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# ============================================================================
# SECURITY (CRITICAL - MUST CHANGE IN PRODUCTION)
# ============================================================================
# JWT Secret - Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
# MUST be 64+ characters in production
JWT_SECRET_KEY=CHANGE_THIS_GENERATE_WITH_python_c_import_secrets_print_secrets_token_urlsafe_64

# Token Expiration
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
BCRYPT_ROUNDS=12

# ============================================================================
# CELERY (Task Queue)
# ============================================================================
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/1
CELERY_TASK_ALWAYS_EAGER=false   # Set true for testing without Redis

# ============================================================================
# CORS
# ============================================================================
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000,http://localhost:8080

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_ENABLED=false         # Enable in production
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_STORAGE=redis

# ============================================================================
# FILE STORAGE
# ============================================================================
UPLOAD_DIR=data/uploads
MAX_UPLOAD_SIZE=104857600        # 100MB

# S3 Storage (Production)
STORAGE_TYPE=local               # local | s3
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# S3_BUCKET_NAME=shiksha-setu-uploads

# ============================================================================
# ML/AI MODELS - OPTIMAL 2025 STACK
# ============================================================================
MODEL_CACHE_DIR=data/models
HF_HOME=data/models/huggingface

# Device Configuration
DEVICE=auto                      # auto | cuda | mps | cpu
USE_QUANTIZATION=true
QUANTIZATION_TYPE=int4           # int4 | int8 | fp16
USE_FLASH_ATTENTION=true
MAX_GPU_MEMORY_GB=16.0

# --- Text Simplification ---
SIMPLIFICATION_MODEL_ID=Qwen/Qwen2.5-3B-Instruct
SIMPLIFICATION_BACKEND=transformers  # transformers | vllm
SIMPLIFICATION_MAX_LENGTH=4096
SIMPLIFICATION_TEMPERATURE=0.7

# --- Translation ---
TRANSLATION_MODEL_ID=ai4bharat/indictrans2-en-indic-1B
TRANSLATION_BACKEND=transformers
TRANSLATION_MAX_LENGTH=2048

# --- Embeddings ---
EMBEDDING_MODEL_ID=BAAI/bge-m3
EMBEDDING_DIMENSION=1024
EMBEDDING_MAX_LENGTH=8192
EMBEDDING_BATCH_SIZE=32

# --- Reranker ---
RERANKER_MODEL_ID=BAAI/bge-reranker-v2-m3
RERANKER_TOP_K=10

# --- OCR ---
OCR_MODEL_ID=ucaslcl/GOT-OCR2_0
OCR_BACKEND=transformers
OCR_MAX_IMAGE_SIZE=2048

# --- Validation ---
VALIDATION_MODEL_ID=google/gemma-2-2b-it
VALIDATION_BACKEND=transformers

# --- Text-to-Speech (Facebook MMS-TTS) ---
# MMS-TTS: 1100+ languages, best quality for Indian languages
# Models: facebook/mms-tts-{lang} where lang is ISO 639-3 code
# Hindi=hin, Tamil=tam, Telugu=tel, Bengali=ben, Marathi=mar, etc.
TTS_MODEL_ID=facebook/mms-tts-hin
TTS_SAMPLE_RATE=16000

# ============================================================================
# vLLM PRODUCTION SERVING (GPU only)
# ============================================================================
VLLM_ENABLED=false               # Enable for production GPU serving
VLLM_HOST=localhost
VLLM_PORT=8001
VLLM_TENSOR_PARALLEL_SIZE=1
VLLM_GPU_MEMORY_UTILIZATION=0.90
VLLM_MAX_MODEL_LEN=4096
VLLM_QUANTIZATION=awq            # awq | gptq | none
VLLM_SWAP_SPACE_GB=4
VLLM_ENABLE_PREFIX_CACHING=true

# ============================================================================
# API KEYS
# ============================================================================
# HuggingFace (for cloud inference)
HUGGINGFACE_API_KEY=

# ============================================================================
# OBSERVABILITY
# ============================================================================
LOG_LEVEL=INFO
LOG_DIR=logs
LOG_FILE=shiksha_setu.log

# Sentry Error Tracking (optional)
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus Metrics
PROMETHEUS_ENABLED=true

# ============================================================================
# TESTING
# ============================================================================
TESTING=false
TEST_DATABASE_URL=postgresql://postgres:password@localhost:5432/shiksha_setu_test

# ============================================================================
# FRONTEND (Vite)
# ============================================================================
VITE_API_BASE_URL=http://localhost:8000
VITE_WS_BASE_URL=ws://localhost:8000
